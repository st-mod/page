var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};function n(e){const t=Number(getComputedStyle(e).fontSize.slice(0,-2));let n=1/t,i=1/t;const o=e.closest("foreignObject");if(null!==o){const{height:e,width:t}=o.getBoundingClientRect();n*=o.height.animVal.value/e,i*=o.width.animVal.value/t}return{heightScale:n,widthScale:i}}e.d(t,{IQ:()=>v,h0:()=>b,Md:()=>f,$F:()=>r,_8:()=>a});const i=r("210mm"),o=r("297mm");function r(e){return"string"!=typeof e?NaN:e.endsWith("px")?Number(e.slice(0,-2)):e.endsWith("cm")?96*Number(e.slice(0,-2))/2.54:e.endsWith("mm")?96*Number(e.slice(0,-2))/25.4:e.endsWith("in")?96*Number(e.slice(0,-2)):e.endsWith("pc")?16*Number(e.slice(0,-2)):e.endsWith("pt")?4*Number(e.slice(0,-2))/3:NaN}function a(e){if("string"!=typeof e)return{width:i,height:o};if(e.endsWith(" landscape")){const{width:t,height:n}=a(e.slice(0,-10).trim());return{width:n,height:t}}if(e.endsWith(" portrait"))return a(e.slice(0,-9).trim());if("A5"===e)return{width:r("148mm"),height:r("210mm")};if("A4"===e)return{width:r("210mm"),height:r("297mm")};if("A3"===e)return{width:r("297mm"),height:r("420mm")};if("B5"===e)return{width:r("176mm"),height:r("250mm")};if("B4"===e)return{width:r("250mm"),height:r("353mm")};if("JIS-B5"===e)return{width:r("182mm"),height:r("257mm")};if("JIS-B4"===e)return{width:r("257mm"),height:r("364mm")};if("letter"===e)return{width:r("8.5in"),height:r("11in")};if("legal"===e)return{width:r("8.5in"),height:r("14in")};if("ledger"===e)return{width:r("11in"),height:r("17in")};const[t,n]=e.trim().split(/\s+/,2).map(r);return isFinite(t)&&t>0?void 0===n?{width:t,height:t}:isFinite(n)&&n>0?{width:t,height:n}:{width:t,height:o}:isFinite(n)&&n>0?{width:i,height:n}:{width:i,height:o}}let l;function d(e,t){for(const n of e)if(t.base.lineToInlinePlainString(n).length>0)return n;return[]}function c(e,t){for(;;){for(;null!==e.nextSibling;)e.nextSibling.remove();if(null===e.parentNode||e.parentNode===t)break;e=e.parentNode}}function s(e,t,n,i){if(0===t&&n===1/0)return;void 0===i&&(i=e.querySelectorAll(".breakable>*"));const o=i[t-1],r=i[n-1];void 0!==o&&(function(e,t){for(;;){for(;null!==e.previousSibling;)e.previousSibling.remove();if(null===e.parentNode||e.parentNode===t)break;e=e.parentNode}}(o,e),o.remove()),void 0!==r&&c(r,e)}async function g(e,t,n,i,o){const r=(await o.compileSTDN([[e]])).children[0];s(r,n,i),t.append(r)}async function m(e,t,n,i,o,r){const a=t.cloneNode(!0),l=a.querySelectorAll(".breakable>*");if(s(a,o,1/0,l),n.append(a),a.getBoundingClientRect().bottom<=n.getBoundingClientRect().bottom)return a.remove(),s(t,o,1/0),void n.append(t);for(let t=l.length;t>o;t--)if(c(l[t-1],a),!(a.getBoundingClientRect().bottom>n.getBoundingClientRect().bottom))return a.remove(),await g(e,n,o,t,r),t;if(a.remove(),i)return o;s(t,o,1/0),n.append(t)}function h(e,t){const n=e%2==0,i=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),r=document.createElement("div"),a=document.createElement("header"),l=document.createElement("main"),d=document.createElement("footer"),c=document.createElement("div"),s=document.createElement("div"),g=document.createElement("span"),m=document.createElement("span");i.append(o),o.append(r),r.append(a),r.append(l),r.append(d),a.append(c),d.append(s),c.append(g),c.append(m),i.setAttribute("viewBox",`0 0 ${t.width} ${t.height}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),r.style.fontSize="16px";const h=`calc(${t.marginLeft} + ${t.binging})`;return r.style.marginLeft=n?t.marginRight:h,r.style.marginRight=n?h:t.marginRight,a.style.height=t.marginTop,l.style.display="flow-root",l.style.height=`calc(${t.height}px - ${t.marginTop} - ${t.marginBottom})`,d.style.height=t.marginBottom,s.textContent=e.toString(),{element:i,headingIndexEle:g,headingContentEle:m,main:l,indexEle:s}}async function p(e,t,n,i){const o=t[e%2==0?i.leftHeaderLevel:i.rightHeaderLevel];if(void 0!==o){"heading"===o.orbit&&n.headingIndexEle.append(new Text(o.index.join(".")));const{abbr:e}=o.unit.options;"string"==typeof e?n.headingContentEle.append(new Text(e)):"object"==typeof e?n.headingContentEle.append(await i.compiler.compileLine(d(e,i.compiler))):n.headingContentEle.append(await i.compiler.compileLine(d(o.unit.children,i.compiler)))}}const u=new Map,f=async(e,t)=>{const n=document.createElement("div");let i,o=u.get(t);if(void 0!==o)return n;if(i=void 0!==t.context.root?t.context.root.querySelector(":host>div"):document.body.querySelector(":scope>.lr-struct>main>article"),null===i)return n;const r=i,d=a(e.options.size),{marginTop:c,marginRight:s,marginBottom:g,marginLeft:f}=function(e){if("string"!=typeof e)return{marginTop:".4in",marginRight:".4in",marginBottom:".4in",marginLeft:".4in"};const t=e.trim().split(/\s+/,4);return 1===t.length?{marginTop:t[0],marginRight:t[0],marginBottom:t[0],marginLeft:t[0]}:2===t.length?{marginTop:t[0],marginRight:t[1],marginBottom:t[0],marginLeft:t[1]}:3===t.length?{marginTop:t[0],marginRight:t[1],marginBottom:t[2],marginLeft:t[1]}:{marginTop:t[0],marginRight:t[1],marginBottom:t[2],marginLeft:t[3]}}(e.options.margin),{leftHeaderLevel:v,rightHeaderLevel:b}=function(e){if("number"==typeof e&&isFinite(e)&&e%1==0&&e>=0)return{leftHeaderLevel:e,rightHeaderLevel:e};if("string"!=typeof e)return{leftHeaderLevel:0,rightHeaderLevel:1};const[t,n]=e.trim().split(/\s+/,2).map(Number);return isFinite(t)&&t%1==0&&t>=0?void 0===n?{leftHeaderLevel:t,rightHeaderLevel:t}:isFinite(n)&&n%1==0&&n>=0?{leftHeaderLevel:t,rightHeaderLevel:n}:{leftHeaderLevel:t,rightHeaderLevel:1}:isFinite(n)&&n%1==0&&n>=0?{leftHeaderLevel:0,rightHeaderLevel:n}:{leftHeaderLevel:0,rightHeaderLevel:1}}(e.options["header-level"]),{rightLevel:w,breakLevel:y}=function(e,t){return("number"!=typeof e||!isFinite(e)||e%1!=0||e<0)&&(e=0),("number"!=typeof t||!isFinite(t)||t%1!=0||t<e)&&(t=e),{rightLevel:e,breakLevel:t}}(e.options["right-level"],e.options["break-level"]);var L;u.set(t,o={width:d.width,height:d.height,marginTop:c,marginRight:s,marginBottom:g,marginLeft:f,binging:(L=e.options.binging,"number"==typeof L?L+"px":"string"==typeof L?L:"0px"),leftHeaderLevel:v,rightHeaderLevel:b,rightLevel:w,breakLevel:y,headings:t.context.indexInfoArray.filter((e=>"heading"===e.orbit||"title"===e.unit.tag)),idToPageIndex:{},pagedListeners:[],compiler:t}),function({width:e,height:t},n){if(void 0!==n)return;void 0===l&&(l=document.createElement("style"));const i=`@page {\n    margin: 0;\n    size: ${e}px ${t}px;\n}\n\nbody>.lr-struct>main>article {\n    max-width: ${e}px;\n}`;l.textContent!==i&&(l.textContent=i),document.head.append(l)}(d,t.context.root);const x=o,E=function(e){return"number"==typeof e&&isFinite(e)&&e>=0?1e3*e:1e3}(e.options["break-delay"]);return function(e,t,n){const i=new MutationObserver(l),o=window.setInterval(l,1e3);let r,a=!1;async function l(){t.isConnected&&!a&&(a=!0,i.disconnect(),clearInterval(o),await e())}r=void 0===n?document.body.querySelector(":scope>.lr-struct>main>article"):n instanceof ShadowRoot?n.querySelector(":host>div"):n,null===r&&(r=document.body),i.observe(r,{childList:!0,subtree:!0})}((async()=>{await new Promise((e=>setTimeout(e,E))),await async function(e,t,n){t.innerHTML="";let i=n.headings,o=1,r=1,a=h(r,n);const l=[a];t.append(a.element);let d=!1;function c(){o++,l.push(a=h(++r,n)),t.append(a.element),d=!1}for(const t of e){const e=[];let l=1/0;for(const n of i){const{id:i,index:o,orbit:r}=n;if(null===t.querySelector(`[id=${JSON.stringify(i)}]`)){e.push(n);continue}const a="heading"===r?o.length:0;l>a&&(l=a)}if(i=e,t.children.length>0){const e=t.children[0];if(e.classList.contains("break")){(l<=n.rightLevel||e.classList.contains("right"))&&o%2==1&&c();const t=n.compiler.context.idToIndexInfo[e.id];if(void 0!==t&&"break"===t.unit.tag){const{index:e}=t.unit.options;"number"==typeof e&&isFinite(e)&&e%1==0&&e>=1&&(r=e-1)}c()}else l<=n.breakLevel&&(d&&c(),l<=n.rightLevel&&o%2==0&&c())}if(1===t.children.length&&1===t.childNodes.length){const e=n.compiler.context.idToIndexInfo[t.children[0].id];if(void 0!==e){let i=0;for(;;){const o=await m(e.unit,t,a.main,d,i,n.compiler);if(void 0===o){!d&&t.childNodes.length>0&&t.getBoundingClientRect().height>0&&(d=!0);break}i=o,c()}continue}}a.main.append(t),!d||t.getBoundingClientRect().bottom<=a.main.getBoundingClientRect().bottom||(c(),a.main.append(t),t.childNodes.length>0&&t.getBoundingClientRect().height>0&&(d=!0))}await async function(e,t){let n=t.headings,i=[],o=0;for(const r of e){const e=[];for(const o of n){const{id:n,index:a,orbit:l}=o;if(null===r.main.querySelector(`[id=${JSON.stringify(n)}]`)){e.push(o);continue}t.idToPageIndex[n]=r.indexEle.textContent??void 0;const d="heading"===l?a.length:0;for(let e=d+1;e<i.length;e++)i[e]=void 0;i[d]=o}n=e,await p(++o,i,r,t)}}(l,n)}(Array.from(r.children),r,x);for(const e of x.pagedListeners)await e();void 0!==t.context.root&&t.context.root.dispatchEvent(new Event("adjust",{bubbles:!0,composed:!0}))}),n,r),n},v=async(e,t)=>{const i=document.createElement("div"),o=u.get(t);if(void 0===o)return i;i.classList.add("breakable");const r="number"==typeof(a=e.options["dot-gap"]??t.extractor.extractLastGlobalOption("dot-gap","contents",t.context.tagToGlobalOptions))&&isFinite(a)&&a>0?a:1;var a;for(const{unit:e,orbit:a,index:l,id:c}of o.headings){if("heading"!==a||l.length>3)continue;const s=document.createElement("div"),g=document.createElement("span"),m=document.createElement("span"),h=document.createElement("div"),p=document.createElement("a");s.classList.add(`level${l.length}`),p.href=`#${encodeURIComponent(c)}`,i.append(s),s.append(g),s.append(m),s.append(h),h.append(p),g.append(new Text(l.join("."))),m.append(await t.compileLine(d(e.children,t))),o.pagedListeners.push((async()=>{p.textContent=o.idToPageIndex[c]??"";const{widthScale:e}=n(h);if(!isFinite(e))return;let{left:t}=s.getBoundingClientRect();const{top:i,left:a}=p.getBoundingClientRect();for(const{right:e,bottom:n}of m.getClientRects())n>=i&&e>t&&(t=e);if(a<=t)return;const l=Math.floor((a-t)*e/r);for(let e=0;e<l;e++){const e=document.createElement("div");e.style.width=`${r}em`,p.before(e)}}))}return i},b=async(e,t)=>{const n=document.createElement("h1");return n.append(await t.compileSTDN(e.children)),n};var w=t.IQ,y=t.h0,L=t.Md,x=t.$F,E=t._8;export{w as contents,y as h0,L as page,x as parseLength,E as parseSize};